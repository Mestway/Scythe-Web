<!DOCTYPE html>
<html lang="en">
<head>
  <title>Scythe</title>
  <script src="./static/scripts/jquery-3.1.1.js" type="text/javascript" charset="utf-8"></script>

  <link href="./static/lib/bootstrap/css/bootstrap.css" rel="stylesheet" />
  <script src="./static/lib/bootstrap/js/bootstrap.js" type="text/javascript" charset="utf-8"></script>

  <link rel="stylesheet" type="text/css" href="./static/css/main.css" />
  
  <script src="./static/lib/d3/d3.js" type="text/javascript" charset="utf-8"></script>
  <script src="./static/scripts/d3-tip.js" type="text/javascript" charset="utf-8"></script>

  <script src="./static/scripts/util.js" type="text/javascript" charset="utf-8"></script>
  
  <script src="./static/lib/jquery-ui-1.12.1.custom/jquery-ui.js" type="text/javascript" charset="utf-8"></script>
  <script src="./static/scripts/jquery.fileupload.js" type="text/javascript" charset="utf-8"></script>

  <script type="text/javascript" charset="utf8" src="./static/lib/DataTables/media/js/jquery.dataTables.js"></script>
  <link rel="stylesheet" type="text/css" href="./static/lib/DataTables/media/css/jquery.datatables.css">

  <script type="text/javascript" charset="utf8" src="./static/scripts/mindmup-editabletable.js"></script>
  <script type="text/javascript" src="./static/scripts/main.js"></script>

  <!-- enahnced dropdown -->
  <script type="text/javascript" charset="utf8" src="./static/lib/dropdowns-enhancement/dropdowns-enhancement.js"></script>
  <link rel="stylesheet" type="text/css" href="./static/lib/dropdowns-enhancement/dropdowns-enhancement.css">

</head>

<body>
  <nav class="navbar navbar-inverse navbar-static-top navbar-full">
    <div class="container-fluid">
      <div class="navbar-header">
        <div class="navbar-brand">Scythe</div> 
      </div>
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">Home</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right" style="padding: 0px 15px">
        <li>
            <button class="btn btn-primary navbar-btn">Connect</button>
            <button class="btn btn-danger navbar-btn">Disconnect</button>
        </li>
      </ul>
    </div>
  </nav>

  <!--<div id="place_holder" class="dash-box-w-text" style="width: 98%; margin: 0 auto;"> Start By Uploading Your Data.</div>-->
  <div id="wrapper">
    <div id="interactive-panels" panel-cnt="0">
      <div class="buttons">
        <button id="add_panel" class="btn btn-success"><span class="glyphicon glyphicon-plus"></span> New Panel</button>
        <button id="remove_panel" class="btn btn-danger"><span class="glyphicon glyphicon-minus"></span> Remove Panel</button>
      </div>
  </div>

  <div id="test"></div>
</body>

<script>

var input_csv = null;

$(function() {
  $('#add_panel').click(function () {

    panel_id = parseInt($("#interactive-panels").attr("panel-cnt"));
    $("#interactive-panels").attr("panel-cnt", panel_id + 1);

    output_panel_content_empty = "<tr><td>empty</td><td>empty</td><td>empty</td></tr>\
                <tr><td>empty</td><td>empty</td><td>empty</td></tr>\
                <tr><td>empty</td><td>empty</td><td>empty</td></tr>";

    output_panel_content = "<tr><td>H. Simon</td><td>1974</td><td>277</td></tr>\
                <tr><td>R. Tibshiran...</td><td>1995</td><td>51</td></tr>\
                <tr><td>P. Bork</td><td>1998</td><td>51</td></tr>";

    input_panel_content = "<tr><td>empty</td><td>empty</td><td>empty</td></tr>\
                <tr><td>empty</td><td>empty</td><td>empty</td></tr>\
                <tr><td>empty</td><td>empty</td><td>empty</td></tr>\
                <tr><td>empty</td><td>empty</td><td>empty</td></tr>";

    panel_content = 
      "<table id=\"panel"  + panel_id + "\" class=\"ipanel dash-box\" style=\"width:100%;table-layout: fixed;\">\
        <tr>\
          <td style='width: 35%;vertical-align:top;border-right:1px dashed gray;'>\
            <div class=\"input-example\" sub_panel_cnt='1' id=\"input-example" + panel_id + "\">\
              <div id=\"input-example" + panel_id +  "sub" + 1 + "\"></div>\
            </div>\
            <div id='constraint-panel" + panel_id + "'>\
              <div class='input-group input-group-sm input-box constant-panel'>\
                <span class='input-group-addon' id='basic-addon1" + panel_id + "'>Constants</span>\
                <input type='text' class='form-control' placeholder='None' aria-describedby='basic-addon1" + panel_id + "'>\
              </div>\
              <div class='input-group input-group-sm input-box aggr-func-panel'>\
                <span class='input-group-addon' id='basic-addon2" + panel_id + "'>Aggregators</span>\
                <input type='text' class='form-control' placeholder='None' aria-describedby='basic-addon2" + panel_id + "'>\
              </div>\
            </div>\
          </td>\
          <td style='width: 20%;vertical-align:top;'>\
            <div class=\"output-example\" id=\"output-example" + panel_id + "\"></div>\
          </td>\
          <td style='width: 43%;vertical-align:top;'>\
            <div class=\"viz\"  id=\"viz" + panel_id + "\">\
              <div id=\"query" + panel_id + "\" class=\"pnl\" style=\"display:none\"></div>\
              <div viz_type=\"histogram\" id=\"viz-output" + panel_id + "\" class=\"pnl\" style=\"display:block;\"></div>\
              <div viz_type=\"histogram\" id=\"viz-full" + panel_id + "\" class=\"pnl\" style=\"display:none;\"></div>\
            </div>\
          </td>\
        </tr>\
        <tr style='height:0px;'>\
          <td style='border-right:1px dashed gray;'><div current_panel_id=\"" + panel_id + "\" id=\"input-panel-btns" + panel_id + "\"></div></td>\
          <td><div id='synthesize-btn-container" + panel_id + "'></div></td>\
          <td><div class=\"buttons btn-group btn-group-justified\" style='padding-left:10px;padding-right:10px;'>\
                <label class=\"btn btn-default\" id=\"viz-query-btn" + panel_id + "\">Query</label>\
                <label class=\"btn btn-default\" id=\"viz-output-btn" + panel_id + "\">Vis-Ouput</label>\
                <label class=\"btn btn-default\" id=\"viz-full-btn" + panel_id + "\">Vis-Full</label>\
                <div class='btn-group'>\
                  <label data-toggle='dropdown' class='btn btn-default dropdown-toggle pull-right'><i class='icon-edit'></i> Visualization <span class='caret'></span></label>\
                  <ul class='dropdown-menu'>\
                    <li>\
                      <input type='radio' id='ex2_2_1' name='ex2_2' value='1' checked=''>\
                      <label for='ex2_2_1'><i class='icon-edit'></i> Histogram</label>\
                    </li>\
                    <li>\
                      <input type='radio' id='ex2_2_2' name='ex2_2' value='2'>\
                      <label for='ex2_2_2'><i class='icon-remove'></i> 3D Histogram</label>\
                    </li>\
                  </ul>\
                </div>\
              </div></td>\
        </tr>\
      </table>\
      <br/>";

    synthesize_btn_id = "synthesize_btn" + panel_id;
    fileupload_id = "fileupload" + panel_id;

    input_example_id = "input-example" + panel_id;
    output_example_id = "output-example" + panel_id;

    $("#interactive-panels").append(panel_content);

    gen_adjustable_table_div("input-example" + panel_id +  "sub" + 1, "itable_" + panel_id + "_" + 1 );
    //gen_adjustable_table_div("input-example" + panel_id +  "sub" + 2, "sm-in-tbl" + panel_id);
    gen_adjustable_table_div("output-example" + panel_id, "otable_" + panel_id);
    gen_input_panel_btn("input-panel-btns" + panel_id, "itable_upload_btn_" + panel_id, "itable_" + panel_id + "_" + 1);
    gen_synthesize_btn("synthesize-btn-container" + panel_id, "synthesize-btn" + panel_id, ["itable_" + panel_id + "_" + 1], "otable_" + panel_id, "constraint-panel" + panel_id, "query" + panel_id, "viz-full" + panel_id);
    //draw_viz_out(panel_id);

    set_hist_viz_btn = "set_histogram" + panel_id;
    set_2d_hist_viz_btn = "set_2d_histogram" + panel_id;

    $("#" + set_hist_viz_btn).click(function() {
      panel_id = $(this).attr("panel_id");
      $("#viz-output" + panel_id).attr("viz_type", "histogram");
      $("#viz-full" + panel_id).attr("viz_type", "histogram");
    });
    $("#" + set_2d_hist_viz_btn).click(function() {
      panel_id = $(this).attr("panel_id");
      $("#viz-output" + panel_id).attr("viz_type", "2dhistogram");
      $("#viz-full" + panel_id).attr("viz_type", "2dhistogram");
    });
    
    viz_query_btn = "viz-query-btn" + panel_id;
    viz_output_btn = "viz-output-btn" + panel_id;
    viz_full_btn = "viz-full-btn" + panel_id;
    $(function() {
      $("#" + viz_query_btn).click(function () {
        id = this.id.substring(this.id.length-1);
        $("#query" + id).attr("style", "display: block; width:100%;");
        $("#viz-output" + id).attr("style", "display: none");
        $("#viz-full" + id).attr("style", "display: none");
      });
    });
    $(function() {
      $("#" + viz_full_btn).click(function () {
        id = this.id.substring(this.id.length-1);
        $("#query" + id).attr("style", "display: none");
        $("#viz-output" + id).attr("style", "display: none");
        $("#viz-full" + id).attr("style", "display: block; width:100%;");
      });
    });
    $(function() {
      $("#" + viz_output_btn).click(function () {
        id = this.id.substring(this.id.length-1);
        $("#query" + id).attr("style", "display: none");
        $("#viz-output" + id).attr("style", "display: block; width:100%;");
        $("#viz-full" + id).attr("style", "display: none");
      });
    });

    $(function() {
      $("#otable_" + panel_id).on("change", function() {
        id = this.id.substring(this.id.length-1);
        draw_viz_out(this.id, "viz-output" + id);
      });
    });
    $("#panel" + panel_id).height(Math.max($("#input-example" + panel_id).height(), $("#output-example" + panel_id).height(), 20));
  });
});

$(function() {
  $('#remove_panel').click(function () {
    $("#interactive-panels .ipanel:last").remove();
  });
});

</script>
</html>
